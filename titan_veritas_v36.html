<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#141C32">
    <title>TITAN VERITAS v3.6 - FSGC Intelligence Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&amp;display=swap" rel="stylesheet">
    <style>
        :root{--main-primary:#5EB3E4;--main-secondary:#DAA900;--main-dark:#141C32;--gray:#ABABAB;--gray-light:#DBDBDB;--danger:#ffc6c2;--warning:#ffe4ad;--success:#c9f8d7;--danger-border:#7c3130;--warning-border:#5d3600;--success-border:#003809}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Roboto',sans-serif;background:#f8f9fa;color:var(--main-dark);min-height:100vh;font-size:14px;line-height:1.5}
        .header{background:var(--main-dark);padding:15px 20px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:15px}
        .header-brand{display:flex;align-items:center;gap:15px}
        .header-logos{display:flex;align-items:center;gap:10px}
        .header-logos img{height:50px;width:auto}
        .header-title h1{color:white;font-size:1.4rem;font-weight:700;letter-spacing:2px;text-transform:uppercase}
        .header-title .subtitle{color:var(--main-primary);font-size:0.75rem;letter-spacing:1px}
        .header-version{background:var(--main-secondary);color:var(--main-dark);font-size:0.65rem;padding:2px 8px;font-weight:700;margin-left:10px}
        .header-stats{display:flex;gap:20px;color:white;font-size:0.85rem}
        .stat-item{display:flex;flex-direction:column;align-items:center}
        .stat-value{font-size:1.5rem;font-weight:700;color:var(--main-primary)}
        .stat-label{font-size:0.7rem;color:var(--gray);text-transform:uppercase}
        .container{max-width:1200px;margin:0 auto;padding:20px}
        .nav-tabs{display:flex;border-bottom:2px solid var(--main-dark);margin-bottom:20px;gap:0}
        .nav-tab{padding:12px 24px;background:transparent;border:none;color:var(--main-dark);font-weight:500;cursor:pointer;text-transform:uppercase;letter-spacing:0.5px;font-size:0.85rem;transition:all 0.2s;border-bottom:3px solid transparent;margin-bottom:-2px}
        .nav-tab:hover{background:#EAEDF7}
        .nav-tab.active{background:var(--main-dark);color:white;border-bottom:3px solid var(--main-secondary)}
        .tab-content{display:none}
        .tab-content.active{display:block}
        .card{background:white;box-shadow:0 2px 8px rgba(0,0,0,0.08);margin-bottom:20px;overflow:hidden}
        .card-header{background:var(--main-dark);color:white;padding:12px 20px;font-weight:500;text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;display:flex;align-items:center;gap:10px}
        .card-header .live-indicator{width:8px;height:8px;background:#22c55e;border-radius:50%;animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{opacity:1;box-shadow:0 0 0 0 rgba(34,197,94,0.7)}50%{opacity:0.8;box-shadow:0 0 0 8px rgba(34,197,94,0)}}
        .card-body{padding:20px}
        .form-group{margin-bottom:15px}
        .form-label{display:block;font-weight:500;margin-bottom:5px;color:var(--main-dark);font-size:0.85rem}
        .form-control{width:100%;padding:12px 15px;border:1px solid var(--gray-light);font-size:0.9rem;transition:border-color 0.2s}
        .form-control:focus{outline:none;border-color:var(--main-primary)}
        .btn{padding:12px 24px;border:none;font-weight:500;cursor:pointer;text-transform:uppercase;letter-spacing:0.5px;font-size:0.85rem;transition:all 0.2s;display:inline-flex;align-items:center;gap:8px}
        .btn-primary{background:var(--main-primary);color:white}
        .btn-primary:hover{background:#4a9fd0}
        .btn-secondary{background:var(--main-secondary);color:var(--main-dark)}
        .btn-dark{background:var(--main-dark);color:white}
        .btn-danger{background:#E15560;color:white}
        .btn-sm{padding:8px 16px;font-size:0.75rem}
        .country-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px;margin-bottom:15px}
        .country-card{display:flex;align-items:center;gap:10px;padding:12px;border:2px solid var(--gray-light);cursor:pointer;transition:all 0.2s;background:white}
        .country-card:hover{border-color:var(--main-primary)}
        .country-card.selected{border-color:var(--main-primary);background:rgba(94,179,228,0.1)}
        .country-flag{font-size:1.5rem}
        .country-info{flex:1}
        .country-name{font-weight:500;font-size:0.9rem}
        .country-source{font-size:0.7rem;color:var(--gray)}
        .progress-container{margin-bottom:20px}
        .progress-bar{height:8px;background:var(--gray-light);overflow:hidden}
        .progress-fill{height:100%;background:linear-gradient(90deg,var(--main-primary),var(--main-secondary));width:0%;transition:width 0.3s}
        .progress-label{font-size:0.8rem;color:var(--gray);margin-top:5px;text-align:center}
        .table-container{overflow-x:auto}
        .results-table{width:100%;border-collapse:collapse;font-size:0.85rem}
        .results-table th{background:var(--main-dark);color:white;padding:12px 15px;text-align:left;text-transform:uppercase;font-size:0.75rem;letter-spacing:0.5px}
        .results-table td{padding:12px 15px;border-bottom:1px solid var(--gray-light)}
        .results-table tr:hover{background:rgba(94,179,228,0.05)}
        .badge{display:inline-block;padding:4px 10px;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.5px}
        .badge-high{background:var(--danger);color:var(--danger-border);border-left:3px solid var(--danger-border)}
        .badge-medium{background:var(--warning);color:var(--warning-border);border-left:3px solid var(--warning-border)}
        .badge-low{background:var(--success);color:var(--success-border);border-left:3px solid var(--success-border)}
        .badge-verified{background:var(--main-primary);color:white}
        .alert{padding:15px 20px;margin-bottom:20px;border-left:4px solid;font-size:0.9rem}
        .alert-info{background:#ddeeed;border-color:#2b4cad;color:#2b4cad}
        .settings-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:15px}
        .toast{position:fixed;bottom:20px;right:20px;background:var(--main-dark);color:white;padding:15px 25px;border-left:4px solid var(--main-secondary);box-shadow:0 4px 20px rgba(0,0,0,0.2);transform:translateX(150%);transition:transform 0.3s;z-index:1000;font-size:0.9rem}
        .toast.show{transform:translateX(0)}
        .modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:1000;padding:20px}
        .modal-overlay.show{display:flex}
        .modal{background:white;max-width:800px;width:100%;max-height:90vh;overflow-y:auto}
        .modal-header{background:var(--main-dark);color:white;padding:15px 20px;display:flex;justify-content:space-between;align-items:center}
        .modal-header h3{font-size:1rem;text-transform:uppercase;letter-spacing:1px}
        .modal-close{background:none;border:none;color:white;font-size:1.5rem;cursor:pointer}
        .modal-body{padding:20px}
        .modal-footer{padding:15px 20px;background:#f8f9fa;display:flex;gap:10px;justify-content:flex-end}
        .empty-state{text-align:center;padding:60px 20px;color:var(--gray)}
        .empty-state-icon{font-size:4rem;margin-bottom:15px}
        .row-actions{display:flex;gap:5px}
        .row-actions button{padding:5px 10px;font-size:0.7rem;background:#EAEDF7;border:none;cursor:pointer;color:var(--main-dark)}
        .row-actions button:hover{background:var(--main-primary);color:white}
        a{color:var(--main-primary);text-decoration:none}
        a:hover{text-decoration:underline}
        @media(max-width:768px){.header{flex-direction:column;align-items:flex-start}.header-stats{width:100%;justify-content:space-around}.nav-tabs{flex-wrap:wrap}.nav-tab{flex:1;text-align:center;padding:10px 15px}.country-grid,.settings-grid{grid-template-columns:1fr}}
        .d-flex{display:flex}.gap-10{gap:10px}.flex-wrap{flex-wrap:wrap}.mt-10{margin-top:10px}.mt-20{margin-top:20px}.mb-20{margin-bottom:20px}
    </style>
</head>
<body>
    <header class="header">
        <div class="header-brand">
            <div class="header-logos">
                <img src="data:image/png;base64,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" alt="Logo Nazionale">
                <img src="data:image/png;base64,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" alt="Logo FSGC">
            </div>
            <div class="header-title">
                <h1>TITAN VERITAS <span class="header-version">v3.6</span></h1>
                <span class="subtitle">Sistema Intelligence per Oriundi ‚Ä¢ FSGC</span>
            </div>
        </div>
        <div class="header-stats">
            <div class="stat-item"><span class="stat-value" id="stat-candidates">0</span><span class="stat-label">Candidati</span></div>
            <div class="stat-item"><span class="stat-value" id="stat-verified">0</span><span class="stat-label">Verificati</span></div>
            <div class="stat-item"><span class="stat-value" id="stat-priority">0</span><span class="stat-label">Alta Priorit√†</span></div>
        </div>
    </header>

    <div class="container">
        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('search')">üîç Ricerca</button>
            <button class="nav-tab" onclick="showTab('results')">üìã Risultati</button>
            <button class="nav-tab" onclick="showTab('report')">üìÑ Report</button>
            <button class="nav-tab" onclick="showTab('settings')">‚öôÔ∏è Impostazioni</button>
        </nav>

        <div id="tab-search" class="tab-content active">
            <div class="card">
                <div class="card-header"><span class="live-indicator"></span>Configurazione Ricerca</div>
                <div class="card-body">
                    <div class="form-group">
                        <label class="form-label">Paesi Target</label>
                        <div class="country-grid">
                            <div class="country-card selected" data-country="argentina" onclick="toggleCountry(this)"><span class="country-flag">üá¶üá∑</span><div class="country-info"><div class="country-name">Argentina</div><div class="country-source">BDFA ‚Ä¢ ZeroZero</div></div></div>
                            <div class="country-card selected" data-country="brazil" onclick="toggleCountry(this)"><span class="country-flag">üáßüá∑</span><div class="country-info"><div class="country-name">Brasile</div><div class="country-source">OGol ‚Ä¢ ZeroZero</div></div></div>
                            <div class="country-card selected" data-country="usa" onclick="toggleCountry(this)"><span class="country-flag">üá∫üá∏</span><div class="country-info"><div class="country-name">USA</div><div class="country-source">TopDrawerSoccer</div></div></div>
                            <div class="country-card" data-country="uruguay" onclick="toggleCountry(this)"><span class="country-flag">üá∫üáæ</span><div class="country-info"><div class="country-name">Uruguay</div><div class="country-source">ZeroZero</div></div></div>
                            <div class="country-card" data-country="chile" onclick="toggleCountry(this)"><span class="country-flag">üá®üá±</span><div class="country-info"><div class="country-name">Cile</div><div class="country-source">ZeroZero</div></div></div>
                            <div class="country-card" data-country="paraguay" onclick="toggleCountry(this)"><span class="country-flag">üáµüáæ</span><div class="country-info"><div class="country-name">Paraguay</div><div class="country-source">Transfermarkt</div></div></div>
                        </div>
                    </div>
                    <div class="settings-grid">
                        <div class="form-group"><label class="form-label">Priorit√† Cognomi</label><select class="form-control" id="surname-priority"><option value="rare">Solo Rari</option><option value="medium" selected>Rari + Medi</option><option value="all">Tutti</option></select></div>
                        <div class="form-group"><label class="form-label">Et√† Min</label><input type="number" class="form-control" id="age-min" value="16"></div>
                        <div class="form-group"><label class="form-label">Et√† Max</label><input type="number" class="form-control" id="age-max" value="28"></div>
                        <div class="form-group"><label class="form-label">Limite Ricerche</label><input type="number" class="form-control" id="search-limit" value="50"></div>
                    </div>
                    <div class="progress-container" style="display:none" id="progress-container"><div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><div class="progress-label" id="progress-label">Inizializzazione...</div></div>
                    <div class="d-flex gap-10 flex-wrap mt-20">
                        <button class="btn btn-primary" onclick="startSearch()">‚ñ∂ Avvia Ricerca</button>
                        <button class="btn btn-secondary" onclick="stopSearch()">‚èπ Stop</button>
                        <button class="btn btn-dark" onclick="loadDefaultSurnames()">üì• Carica Cognomi</button>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">Inserimento Manuale</div>
                <div class="card-body">
                    <div class="settings-grid">
                        <div class="form-group"><label class="form-label">Nome Completo</label><input type="text" class="form-control" id="manual-name" placeholder="es. Juan Gasperoni"></div>
                        <div class="form-group"><label class="form-label">Cognome Sammarinese</label><input type="text" class="form-control" id="manual-surname" placeholder="es. Gasperoni"></div>
                        <div class="form-group"><label class="form-label">Paese</label><input type="text" class="form-control" id="manual-country" placeholder="es. Argentina"></div>
                        <div class="form-group"><label class="form-label">Club</label><input type="text" class="form-control" id="manual-club" placeholder="es. River Plate"></div>
                        <div class="form-group"><label class="form-label">Et√†</label><input type="number" class="form-control" id="manual-age"></div>
                        <div class="form-group"><label class="form-label">Link</label><input type="text" class="form-control" id="manual-link" placeholder="URL profilo"></div>
                    </div>
                    <button class="btn btn-primary mt-10" onclick="addManualCandidate()">‚ûï Aggiungi</button>
                </div>
            </div>
        </div>

        <div id="tab-results" class="tab-content">
            <div class="card">
                <div class="card-header">Candidati <span style="margin-left:auto;font-weight:400;font-size:0.8rem" id="results-count">0</span></div>
                <div class="card-body">
                    <div class="d-flex gap-10 flex-wrap mb-20">
                        <button class="btn btn-sm btn-dark" onclick="filterResults('all')">Tutti</button>
                        <button class="btn btn-sm btn-danger" onclick="filterResults('high')">Alta</button>
                        <button class="btn btn-sm btn-secondary" onclick="filterResults('medium')">Media</button>
                        <button class="btn btn-sm btn-primary" onclick="filterResults('low')">Bassa</button>
                    </div>
                    <div class="table-container">
                        <table class="results-table"><thead><tr><th>Nome</th><th>Cognome</th><th>Paese</th><th>Club</th><th>Et√†</th><th>Priorit√†</th><th>‚úì</th><th>Azioni</th></tr></thead><tbody id="results-body"></tbody></table>
                    </div>
                    <div class="empty-state" id="empty-state"><div class="empty-state-icon">üîç</div><p>Nessun candidato. Avvia una ricerca.</p></div>
                </div>
            </div>
        </div>

        <div id="tab-report" class="tab-content">
            <div class="card">
                <div class="card-header">Report</div>
                <div class="card-body">
                    <div class="settings-grid mb-20">
                        <div class="form-group"><label class="form-label">Titolo</label><input type="text" class="form-control" id="report-title" value="Candidati Oriundi - Analisi"></div>
                        <div class="form-group"><label class="form-label">Note</label><textarea class="form-control" id="report-notes" rows="3"></textarea></div>
                    </div>
                    <div class="d-flex gap-10 flex-wrap">
                        <button class="btn btn-primary" onclick="previewReport()">üëÅÔ∏è Anteprima</button>
                        <button class="btn btn-secondary" onclick="downloadHTML()">üì• HTML</button>
                        <button class="btn btn-dark" onclick="downloadCSV()">üìä CSV</button>
                        <button class="btn btn-dark" onclick="printReport()">üñ®Ô∏è Stampa</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-settings" class="tab-content">
            <div class="card">
                <div class="card-header">API</div>
                <div class="card-body">
                    <div class="alert alert-info">Inserisci le API key per la ricerca automatica.</div>
                    <div class="settings-grid">
                        <div class="form-group"><label class="form-label">Serper API Key</label><input type="password" class="form-control" id="serper-key" placeholder="serper.dev"></div>
                        <div class="form-group"><label class="form-label">OpenRouter Key (opz.)</label><input type="password" class="form-control" id="openrouter-key" placeholder="openrouter.ai"></div>
                    </div>
                    <button class="btn btn-primary mt-10" onclick="saveSettings()">üíæ Salva</button>
                </div>
            </div>
            <div class="card">
                <div class="card-header">Dati</div>
                <div class="card-body">
                    <div class="d-flex gap-10 flex-wrap">
                        <button class="btn btn-secondary" onclick="exportData()">üì§ Esporta</button>
                        <button class="btn btn-dark" onclick="importData()">üì• Importa</button>
                        <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è Cancella</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="modal-report">
        <div class="modal">
            <div class="modal-header"><h3>Anteprima</h3><button class="modal-close" onclick="closeModal('modal-report')">√ó</button></div>
            <div class="modal-body"><div id="report-preview-content"></div></div>
            <div class="modal-footer"><button class="btn btn-dark" onclick="closeModal('modal-report')">Chiudi</button><button class="btn btn-primary" onclick="downloadHTML()">Scarica</button></div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        var candidates = [];
        var verified = [];
        var isSearching = false;
        
        var SURNAMES = {
            rare: ['Gasperoni','Mularoni','Zonzini','Zafferani','Vitaioli','Bacciocchi','Capicchioni','Tamagnini','Simoncini','Podeschi','Muraccini','Stolfi','Cioncolini','Volpinari','Marquisio','Carchia'],
            medium: ['Guidi','Casadei','Zanotti','Giardi','Selva','Ghiotti','Maiani','Ceci','Francini','Ercolani','Felici','Matteoni','Nanni','Pasolini','Raschi','Stefanelli','Valli','Berardi','Benedettini','Tura','Mazzotti','Michelotti','Renzetti','Salvini','Graziani','Lombardi','Riva','Zoli'],
            common: ['Rossi','Bianchi','Valentini','Della Valle','Amati','Angelini','Fabbri','Ferrari','Conti','Morri']
        };

        var COUNTRY_SOURCES = {
            argentina: { primary: 'bdfa.com.ar', flag: 'üá¶üá∑' },
            brazil: { primary: 'ogol.com.br', flag: 'üáßüá∑' },
            usa: { primary: 'topdrawersoccer.com', flag: 'üá∫üá∏' },
            uruguay: { primary: 'zerozero.com.ar', flag: 'üá∫üáæ' },
            chile: { primary: 'zerozero.cl', flag: 'üá®üá±' },
            paraguay: { primary: 'transfermarkt.com', flag: 'üáµüáæ' }
        };

        var ITALIAN_CLUBS = ['juventus','inter','milan','roma','napoli','lazio','fiorentina','atalanta','torino','bologna','verona','udinese','sassuolo','empoli','lecce','monza','cesena','rimini','ravenna','pistoiese','serie a','serie b'];

        document.addEventListener('DOMContentLoaded', function() {
            loadFromStorage();
            renderResults();
            updateStats();
            loadSettings();
        });

        function loadFromStorage() {
            var stored = localStorage.getItem('titan_v36_candidates');
            if (stored) candidates = JSON.parse(stored);
            var storedV = localStorage.getItem('titan_v36_verified');
            if (storedV) verified = JSON.parse(storedV);
        }

        function saveToStorage() {
            localStorage.setItem('titan_v36_candidates', JSON.stringify(candidates));
            localStorage.setItem('titan_v36_verified', JSON.stringify(verified));
        }

        function loadSettings() {
            var sk = localStorage.getItem('titan_serper_key');
            var ok = localStorage.getItem('titan_openrouter_key');
            if (sk) document.getElementById('serper-key').value = sk;
            if (ok) document.getElementById('openrouter-key').value = ok;
        }

        function saveSettings() {
            localStorage.setItem('titan_serper_key', document.getElementById('serper-key').value);
            localStorage.setItem('titan_openrouter_key', document.getElementById('openrouter-key').value);
            showToast('Salvato');
        }

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(function(t) { t.classList.remove('active'); });
            document.querySelectorAll('.nav-tab').forEach(function(t) { t.classList.remove('active'); });
            document.getElementById('tab-' + tabId).classList.add('active');
            event.target.classList.add('active');
        }

        function toggleCountry(el) { el.classList.toggle('selected'); }

        function getSelectedCountries() {
            var sel = [];
            document.querySelectorAll('.country-card.selected').forEach(function(c) { sel.push(c.dataset.country); });
            return sel;
        }

        function showToast(msg) {
            var t = document.getElementById('toast');
            t.textContent = msg;
            t.classList.add('show');
            setTimeout(function() { t.classList.remove('show'); }, 3000);
        }

        function updateProgress(cur, tot, txt) {
            var pct = Math.round((cur / tot) * 100);
            document.getElementById('progress-fill').style.width = pct + '%';
            document.getElementById('progress-label').textContent = txt + ' (' + cur + '/' + tot + ')';
        }

        function openModal(id) { document.getElementById(id).classList.add('show'); }
        function closeModal(id) { document.getElementById(id).classList.remove('show'); }

        function startSearch() {
            var serperKey = localStorage.getItem('titan_serper_key');
            if (!serperKey) { showToast('Inserisci Serper API Key'); return; }
            var countries = getSelectedCountries();
            if (countries.length === 0) { showToast('Seleziona paesi'); return; }
            var priority = document.getElementById('surname-priority').value;
            var limit = parseInt(document.getElementById('search-limit').value) || 50;
            var ageMin = parseInt(document.getElementById('age-min').value) || 16;
            var ageMax = parseInt(document.getElementById('age-max').value) || 28;
            var surnames = SURNAMES.rare.slice();
            if (priority === 'medium' || priority === 'all') surnames = surnames.concat(SURNAMES.medium);
            if (priority === 'all') surnames = surnames.concat(SURNAMES.common);
            isSearching = true;
            document.getElementById('progress-container').style.display = 'block';
            var searchCount = 0;
            var maxSearches = Math.min(limit, surnames.length * countries.length);
            
            (function searchLoop(sIdx, cIdx) {
                if (!isSearching || searchCount >= limit || sIdx >= surnames.length) {
                    isSearching = false;
                    document.getElementById('progress-container').style.display = 'none';
                    renderResults();
                    showToast('Completato: ' + candidates.length + ' candidati');
                    return;
                }
                var surname = surnames[sIdx];
                var country = countries[cIdx];
                updateProgress(searchCount, maxSearches, 'Cercando ' + surname);
                var source = COUNTRY_SOURCES[country];
                var query = 'site:' + source.primary + ' "' + surname + '" futbolista jogador player';
                
                fetch('https://google.serper.dev/search', {
                    method: 'POST',
                    headers: { 'X-API-KEY': serperKey, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ q: query, num: 5 })
                })
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    if (data.organic) {
                        data.organic.forEach(function(result) {
                            var candidate = parseResult(result, surname, country);
                            if (candidate && isValidCandidate(candidate, ageMin, ageMax)) {
                                candidates.push(candidate);
                                saveToStorage();
                                updateStats();
                            }
                        });
                    }
                })
                .catch(function(e) { console.error(e); })
                .finally(function() {
                    searchCount++;
                    var nextC = cIdx + 1;
                    var nextS = sIdx;
                    if (nextC >= countries.length) { nextC = 0; nextS++; }
                    setTimeout(function() { searchLoop(nextS, nextC); }, 500);
                });
            })(0, 0);
        }

        function stopSearch() { isSearching = false; showToast('Fermato'); }

        function parseResult(result, surname, country) {
            var title = result.title || '';
            var snippet = result.snippet || '';
            var link = result.link || '';
            var combined = (title + ' ' + snippet).toLowerCase();
            for (var i = 0; i < ITALIAN_CLUBS.length; i++) {
                if (combined.indexOf(ITALIAN_CLUBS[i]) >= 0 || link.toLowerCase().indexOf(ITALIAN_CLUBS[i]) >= 0) return null;
            }
            if (combined.indexOf('squad') >= 0 || combined.indexOf('season') >= 0 || combined.indexOf('rosa') >= 0) return null;
            var name = title.split('-')[0].split('|')[0].trim();
            var age = null;
            var ageMatch = combined.match(/(\d{1,2})\s*(years?|a√±os?|anni|anos)/i);
            if (ageMatch) age = parseInt(ageMatch[1]);
            var club = '';
            var clubMatch = combined.match(/(?:plays? for|club|equipo)[:\s]+([^,.\n]+)/i);
            if (clubMatch) club = clubMatch[1].trim();
            var priority = SURNAMES.rare.indexOf(surname) >= 0 ? 'high' : SURNAMES.medium.indexOf(surname) >= 0 ? 'medium' : 'low';
            return {
                id: Date.now() + Math.random().toString(36).substr(2, 9),
                name: name, surname: surname, country: country,
                countryFlag: COUNTRY_SOURCES[country] ? COUNTRY_SOURCES[country].flag : 'üåç',
                club: club, age: age, priority: priority, link: link,
                source: result.displayLink || '', verified: false, addedAt: new Date().toISOString()
            };
        }

        function isValidCandidate(c, ageMin, ageMax) {
            if (c.age && (c.age < ageMin || c.age > ageMax)) return false;
            for (var i = 0; i < candidates.length; i++) {
                if (candidates[i].surname === c.surname && candidates[i].name === c.name && candidates[i].country === c.country) return false;
            }
            return true;
        }

        function addManualCandidate() {
            var name = document.getElementById('manual-name').value.trim();
            var surname = document.getElementById('manual-surname').value.trim();
            var country = document.getElementById('manual-country').value.trim().toLowerCase();
            var club = document.getElementById('manual-club').value.trim();
            var age = parseInt(document.getElementById('manual-age').value) || null;
            var link = document.getElementById('manual-link').value.trim();
            if (!name || !surname) { showToast('Nome e cognome obbligatori'); return; }
            var priority = SURNAMES.rare.indexOf(surname) >= 0 ? 'high' : SURNAMES.medium.indexOf(surname) >= 0 ? 'medium' : 'low';
            candidates.push({
                id: Date.now() + Math.random().toString(36).substr(2, 9),
                name: name, surname: surname, country: country,
                countryFlag: COUNTRY_SOURCES[country] ? COUNTRY_SOURCES[country].flag : 'üåç',
                club: club, age: age, priority: priority, link: link, source: 'Manuale', verified: false, addedAt: new Date().toISOString()
            });
            saveToStorage(); renderResults(); updateStats();
            document.getElementById('manual-name').value = '';
            document.getElementById('manual-surname').value = '';
            document.getElementById('manual-country').value = '';
            document.getElementById('manual-club').value = '';
            document.getElementById('manual-age').value = '';
            document.getElementById('manual-link').value = '';
            showToast('Aggiunto');
        }

        function loadDefaultSurnames() {
            var tot = SURNAMES.rare.length + SURNAMES.medium.length + SURNAMES.common.length;
            showToast('Caricati ' + tot + ' cognomi');
        }

        function renderResults(filter) {
            filter = filter || 'all';
            var tbody = document.getElementById('results-body');
            var emptyState = document.getElementById('empty-state');
            var filtered = filter === 'all' ? candidates : candidates.filter(function(c) { return c.priority === filter; });
            if (filtered.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                document.getElementById('results-count').textContent = '0';
                return;
            }
            emptyState.style.display = 'none';
            document.getElementById('results-count').textContent = filtered.length;
            filtered.sort(function(a, b) {
                var order = { high: 0, medium: 1, low: 2 };
                return order[a.priority] - order[b.priority];
            });
            var html = '';
            for (var i = 0; i < filtered.length; i++) {
                var c = filtered[i];
                html += '<tr>';
                html += '<td>' + escapeHtml(c.name) + '</td>';
                html += '<td><strong>' + escapeHtml(c.surname) + '</strong></td>';
                html += '<td>' + c.countryFlag + ' ' + escapeHtml(c.country) + '</td>';
                html += '<td>' + escapeHtml(c.club || '-') + '</td>';
                html += '<td>' + (c.age || '-') + '</td>';
                html += '<td><span class="badge badge-' + c.priority + '">' + (c.priority === 'high' ? 'Alta' : c.priority === 'medium' ? 'Media' : 'Bassa') + '</span></td>';
                html += '<td>' + (c.verified ? '<span class="badge badge-verified">‚úì</span>' : '-') + '</td>';
                html += '<td class="row-actions">';
                if (c.link) html += '<a href="' + c.link + '" target="_blank"><button>üîó</button></a>';
                html += '<button onclick="toggleVerified(\'' + c.id + '\')">' + (c.verified ? '‚úó' : '‚úì') + '</button>';
                html += '<button onclick="deleteCandidate(\'' + c.id + '\')">üóëÔ∏è</button>';
                html += '</td></tr>';
            }
            tbody.innerHTML = html;
        }

        function filterResults(f) { renderResults(f); }

        function toggleVerified(id) {
            for (var i = 0; i < candidates.length; i++) {
                if (candidates[i].id === id) {
                    candidates[i].verified = !candidates[i].verified;
                    break;
                }
            }
            saveToStorage(); renderResults(); updateStats();
        }

        function deleteCandidate(id) {
            if (confirm('Eliminare?')) {
                candidates = candidates.filter(function(c) { return c.id !== id; });
                saveToStorage(); renderResults(); updateStats(); showToast('Eliminato');
            }
        }

        function updateStats() {
            document.getElementById('stat-candidates').textContent = candidates.length;
            var verCount = 0, highCount = 0;
            for (var i = 0; i < candidates.length; i++) {
                if (candidates[i].verified) verCount++;
                if (candidates[i].priority === 'high') highCount++;
            }
            document.getElementById('stat-verified').textContent = verCount;
            document.getElementById('stat-priority').textContent = highCount;
        }

        function escapeHtml(str) {
            if (!str) return '';
            return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
        }

        function generateReportHTML() {
            var title = document.getElementById('report-title').value || 'Report';
            var notes = document.getElementById('report-notes').value || '';
            var date = new Date().toLocaleDateString('it-IT');
            var high = candidates.filter(function(c) { return c.priority === 'high'; });
            var med = candidates.filter(function(c) { return c.priority === 'medium'; });
            var html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>' + escapeHtml(title) + '</title>';
            html += '<style>body{font-family:Roboto,Arial,sans-serif;max-width:800px;margin:0 auto;padding:40px 20px;color:#141C32}';
            html += '.header{text-align:center;border-bottom:3px solid #141C32;padding-bottom:20px;margin-bottom:30px}';
            html += 'h1{color:#141C32;font-size:1.8rem;margin:10px 0;text-transform:uppercase;letter-spacing:2px}';
            html += '.subtitle{color:#5EB3E4;font-size:0.9rem}';
            html += '.confidential{background:#ffe4ad;color:#5d3600;padding:12px 20px;text-align:center;margin:20px 0;border-left:4px solid #5d3600;font-weight:500}';
            html += '.section{margin:30px 0}.section-title{background:#141C32;color:white;padding:10px 15px;font-weight:500;text-transform:uppercase}';
            html += 'table{width:100%;border-collapse:collapse}th{background:#5EB3E4;color:white;padding:10px;text-align:left;font-size:0.8rem;text-transform:uppercase}';
            html += 'td{padding:10px;border-bottom:1px solid #ddd;font-size:0.85rem}';
            html += '.footer{margin-top:40px;padding-top:20px;border-top:2px solid #141C32;text-align:center;font-size:0.8rem;color:#666}</style></head><body>';
            html += '<div class="header"><h1>' + escapeHtml(title) + '</h1><div class="subtitle">TITAN VERITAS v3.6 ‚Ä¢ FSGC</div>';
            html += '<div class="subtitle">' + date + ' ‚Ä¢ ' + candidates.length + ' candidati</div></div>';
            html += '<div class="confidential">‚ö†Ô∏è CONFIDENZIALE ‚Äî USO INTERNO FSGC ‚Äî DA VERIFICARE</div>';
            if (notes) html += '<div style="background:#f8f9fa;padding:15px;margin:20px 0;border-left:4px solid #5EB3E4"><strong>Note:</strong> ' + escapeHtml(notes) + '</div>';
            if (high.length > 0) {
                html += '<div class="section"><div class="section-title">üî¥ Alta Priorit√† (' + high.length + ')</div>';
                html += '<table><thead><tr><th>Nome</th><th>Cognome</th><th>Paese</th><th>Club</th><th>Et√†</th></tr></thead><tbody>';
                for (var i = 0; i < high.length; i++) {
                    var c = high[i];
                    html += '<tr><td>' + escapeHtml(c.name) + '</td><td><strong>' + escapeHtml(c.surname) + '</strong></td>';
                    html += '<td>' + c.countryFlag + ' ' + escapeHtml(c.country) + '</td><td>' + escapeHtml(c.club || '-') + '</td><td>' + (c.age || '-') + '</td></tr>';
                }
                html += '</tbody></table></div>';
            }
            if (med.length > 0) {
                html += '<div class="section"><div class="section-title">üü° Media Priorit√† (' + med.length + ')</div>';
                html += '<table><thead><tr><th>Nome</th><th>Cognome</th><th>Paese</th><th>Club</th><th>Et√†</th></tr></thead><tbody>';
                for (var j = 0; j < med.length; j++) {
                    var m = med[j];
                    html += '<tr><td>' + escapeHtml(m.name) + '</td><td><strong>' + escapeHtml(m.surname) + '</strong></td>';
                    html += '<td>' + m.countryFlag + ' ' + escapeHtml(m.country) + '</td><td>' + escapeHtml(m.club || '-') + '</td><td>' + (m.age || '-') + '</td></tr>';
                }
                html += '</tbody></table></div>';
            }
            html += '<div class="footer"><strong>TITAN VERITAS v3.6</strong> ‚Äî FSGC<br><em>Dati da verificare tramite anagrafe RSM</em></div></body></html>';
            return html;
        }

        function previewReport() {
            document.getElementById('report-preview-content').innerHTML = generateReportHTML();
            openModal('modal-report');
        }

        function downloadHTML() {
            var blob = new Blob([generateReportHTML()], { type: 'text/html;charset=utf-8' });
            var a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'FSGC_TITAN_Report_' + new Date().toISOString().split('T')[0] + '.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showToast('Scaricato');
        }

        function downloadCSV() {
            var h = ['Nome','Cognome','Paese','Club','Et√†','Priorit√†','Verificato','Link'];
            var rows = [h.join(',')];
            for (var i = 0; i < candidates.length; i++) {
                var c = candidates[i];
                rows.push([c.name, c.surname, c.country, c.club || '', c.age || '', c.priority, c.verified ? 'S√¨' : 'No', c.link || ''].map(function(v) { return '"' + (v || '').toString().replace(/"/g, '""') + '"'; }).join(','));
            }
            var blob = new Blob(['\ufeff' + rows.join('\n')], { type: 'text/csv;charset=utf-8' });
            var a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'FSGC_TITAN_Export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showToast('CSV esportato');
        }

        function printReport() {
            var w = window.open('', '_blank');
            w.document.write(generateReportHTML());
            w.document.close();
            setTimeout(function() { w.print(); }, 500);
        }

        function exportData() {
            var data = { candidates: candidates, verified: verified, version: '3.6', exportedAt: new Date().toISOString() };
            var blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            var a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'TITAN_Backup_' + new Date().toISOString().split('T')[0] + '.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showToast('Esportato');
        }

        function importData() {
            var input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                var reader = new FileReader();
                reader.onload = function(ev) {
                    try {
                        var data = JSON.parse(ev.target.result);
                        if (data.candidates) {
                            candidates = data.candidates;
                            verified = data.verified || [];
                            saveToStorage();
                            renderResults();
                            updateStats();
                            showToast('Importati ' + candidates.length);
                        }
                    } catch (err) { showToast('Errore JSON'); }
                };
                reader.readAsText(e.target.files[0]);
            };
            input.click();
        }

        function clearAllData() {
            if (confirm('Cancellare tutto?')) {
                candidates = [];
                verified = [];
                saveToStorage();
                renderResults();
                updateStats();
                showToast('Cancellato');
            }
        }
    </script>
</body>
</html>
